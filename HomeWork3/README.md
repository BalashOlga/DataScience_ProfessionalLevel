# YOLOv5 Cactus Detection Project

## Описание проекта

Проект реализует детекцию кактусов с использованием YOLOv5 через трансферное обучение. Модель обучена различать два класса:

- **Класс 0**: cactus - кактусы в горшках
- **Класс 1**: cactus_desert - кактусы в пустыне

### Исходный код YOLOv5
При запуске training.py автоматически клонируется репозиторий:
https://github.com/ultralytics/yolov5

## Структура проекта

### Описание структуры:

- **datasets/** - данные для обучения
  - **images/** - изображения
    - train2017/ - обучающая выборка
    - val2017/ - валидационная выборка
  - **labels/** - аннотации
    - train2017/ - разметка для обучения
    - val2017/ - разметка для валидации

- **results/** - результаты работы
  - **detection/** - примеры детекции
    - after_learning/ - после обучения
    - before_laerning/ - до обучения
  - **models/** - сохраненные модели
  - **plots/** - графики и метрики
  - **test_transfer/** - тестирование трансферного обучения

- **training.py** - скрипт обучения
- **data.yaml** - конфигурация данных
- **requirements.txt** - зависимости проекта

## Установка и настройка

**Клонирование репозитория YOLOv5:**
```bash
git clone https://github.com/ultralytics/yolov5
```
**Установка зависимостей(рекомендовано испольвать виртульное окружение):**
```bash
pip install -r requirements.txt
```
## Данные для обучения

Датасет скачан с RoboFlow(необходимо сказать из источника самостоятельно):  
https://universe.roboflow.com/tree-z4xct/ipr_rose_cactus/dataset/3

Исходный датасет содержал 4 класса, но для обучения оставлены только 2 класса:

- **cactus** (кактусы в горшках)
- **cactus_desert** (кактусы в пустыне)

## Обучение модели

**Запуск обучения:**
```bash
python training.py
```
## Параметры обучения

| Параметр | Значение | Описание |
|----------|----------|-----------|
| `--img` | 640 | Размер входного изображения в пикселях |
| `--batch` | 16 | Размер батча для обучения |
| `--epochs` | 50 | Количество эпох обучения |
| `--weights` | yolov5s.pt | Использование предобученной модели YOLOv5s |
| `--freeze` | 10 | Заморозка первых 10 слоев для трансферного обучения |
| `--cache` | - | Кэширование изображений для ускорения обучения |
| `--patience` | 15 | Ранняя остановка при отсутствии улучшений |


## Результаты

### Метрики обучения

По результатам 50 эпох обучения наблюдаются следующие показатели:

| Метрика | Начальное значение | Конечное значение |
|---------|-------------------|------------------|
| Train/box_loss | 0.0882 | 0.031362 |
| Train/obj_loss | 0.03873 | 0.025429 |
| Train/cls_loss | 0.01935 | 0.0016877 |
| Precision | 0.16035 | 0.80988 |
| Recall | 0.17722 | 0.3775 |
| mAP@0.5 | 0.10704 | 0.46479 |
| mAP@0.5:0.95 | 0.043351 | 0.24536 |

### Основные выводы

1. **Эффективность трансферного обучения**: Предобученная модель YOLOv5 быстро адаптировалась к новой задаче детекции кактусов

2. **Стабильность обучения**: Все метрики показывают устойчивое улучшение в течение 50 эпох

3. **Качество детекции**: Precision достиг 81%, что свидетельствует о высокой точности обнаружения объектов

4. **Обнаружение объектов**: Recall 37.75% указывает на то, что модель находит примерно треть всех объектов на изображениях

### Примеры детекции

Примеры работы модели до и после обучения можно посмотреть в папках:

- `detection/before_learning` - до обучения
- `detection/after_learning`  - после обучения с камеры и видео

## Использование

### Детекция с камеры
```bash
python yolov5/detect.py --weights models/best.pt --source 0
```

## Заключение

В рамках учебного проекта успешно реализована детекция двух классов кактусов с использованием трансферного обучения на YOLOv5. Полученные результаты демонстрируют работоспособность подхода, но оставляют пространство для улучшения.

**Достигнутые успехи:**
- Модель научилась различать два класса кактусов
- Precision 81% показывает хорошую точность обнаружения
- Все метрики стабильно улучшались в процессе обучения
- Освоена практика трансферного обучения для компьютерного зрения

**Области для улучшения:**
- Recall 37.75% указывает на недостаточную полноту обнаружения
- mAP 46.48% свидетельствует о среднем качестве детекции
- Требуется доработка для промышленного применения

**Учебная ценность:**
Проект позволил получить практический опыт работы с YOLO, обработки датасетов, настройки гиперпараметров и анализа метрик детекции. Полученные навыки являются хорошей основой для дальнейшего углубления в задачи компьютерного зрения.
